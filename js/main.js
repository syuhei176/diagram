!function(){function n(o){$("#open-register-modal").click(function(){var e=jsmodal("register-modal");e.open({modal:!1}),$("#register-btn").click(function(){var t=$("#diagram-name").val();return""==t?!1:(e.close(),location.hash=t,n(t),!1)})});var a=Snap("#canvas"),d=new Diagram(a);$("#pallet-circle").click(function(){i.push({meta:"node",type:"ellipse",bound:{x:204,y:80,w:100,h:70}})}),$("#pallet-rect").click(function(){i.push({meta:"node",type:"rect",bound:{x:204,y:80,w:100,h:70}})}),$("#pallet-rectangle").click(function(){i.push({meta:"node",type:"rectangle",bound:{x:204,y:80,w:100,h:70}})}),$("#pallet-line").click(function(){i.push({meta:"connection",start:{x:200,y:150},end:{x:250,y:100}})});var i=t.dataStore("drawing").child(o);i.query({}).done(function(n){n.forEach(function(n){"node"==n.meta?d.addNode(n.id,n.type,n.bound):"connection"==n.meta&&d.addConnection(n.id,n.start,n.end)})}),i.on("push",function(n){"node"==n.value.meta?d.addNode(n.id,n.value.type,n.value.bound):"connection"==n.value.meta&&d.addConnection(n.id,n.value.start,n.value.end),e()}),i.on("set",function(n){"node"==n.value.meta?d.updateNode(n.id,n.value.bound):"connection"==n.value.meta&&d.updateConnection(n.id,n.value.start,n.value.end),e()}),i.on("remove",function(n){d.remove(n.id),e()}),d.on("nodeupdate",function(n){i.set(n.id,{meta:"node",bound:n.bound})}),d.on("noderemove",function(n){i.remove(n.id)}),d.on("conupdate",function(n){i.set(n.id,{meta:"connection",start:n.start,end:n.end})})}function e(){document.title="(更新されました)Drawing"}var t=new MilkCocoa("https://io-mi02d8kdu.mlkcca.com:443/");window.edit_diagram=n,$(window).focus(function(){document.title="Drawing"})}();