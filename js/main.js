!function(){function e(o){$("#open-register-modal").click(function(){var n=jsmodal("register-modal");n.open({modal:!1}),$("#register-btn").click(function(){var t=$("#diagram-name").val();return""==t?!1:(n.close(),location.hash=t,e(t),!1)})});var a=Snap("#canvas"),d=new Diagram(a);$("#pallet-circle").click(function(){i.push({meta:"node",type:"ellipse",bound:{x:204,y:80,w:100,h:70}})}),$("#pallet-rect").click(function(){i.push({meta:"node",type:"rect",bound:{x:204,y:80,w:100,h:70}})}),$("#pallet-rectangle").click(function(){i.push({meta:"node",type:"rectangle",bound:{x:204,y:80,w:100,h:70}})}),$("#pallet-line").click(function(){i.push({meta:"connection",start:{x:200,y:150},end:{x:250,y:100}})});var i=t.dataStore("drawing").child(o);i.stream().next(function(e,n){n.forEach(function(e){"node"==e.value.meta?d.addNode(e.id,e.value.type,e.value.bound):"connection"==e.value.meta&&d.addConnection(e.id,e.value.start,e.value.end)})}),i.on("push",function(e){"node"==e.value.meta?d.addNode(e.id,e.value.type,e.value.bound):"connection"==e.value.meta&&d.addConnection(e.id,e.value.start,e.value.end),n()}),i.on("set",function(e){"node"==e.value.meta?d.updateNode(e.id,e.value.bound):"connection"==e.value.meta&&d.updateConnection(e.id,e.value.start,e.value.end),n()}),i.on("remove",function(e){d.remove(e.id),n()}),d.on("nodeupdate",function(e){i.set(e.id,{meta:"node",bound:e.bound})}),d.on("noderemove",function(e){i.remove(e.id)}),d.on("conupdate",function(e){i.set(e.id,{meta:"connection",start:e.start,end:e.end})})}function n(){document.title="(更新されました)Drawing"}var t=new MilkCocoa("flagi9edsvtg.mlkcca.com");window.edit_diagram=e,$(window).focus(function(){document.title="Drawing"})}();