!function(e){function t(e){var t=this;this.snap=e,this.base=this.snap.group();var n=this.snap.rect(0,0,1200,800);this.base.append(n);var o=this.snap.group();n.attr({visibility:"hidden","pointer-events":"fill"}),this.selector=new Selector(e,o),this.connection_selector=new ConnectionSelector(e,o),n.mousedown(function(){t.selector.clear(),t.connection_selector.clear()}),this.listeners={nodeupdate:[],noderemove:[],conupdate:[]},this.nodes={},this.connections={},this.selector.on("changed",function(e){t.fireOnNodeUpdate(e)}),this.selector.on("removed",function(e){t.fireOnNodeRemove(e)}),this.connection_selector.on("changed",function(e){t.fireOnConUpdate(e)})}t.prototype.getGroup=function(){return this.base},t.prototype.addNode=function(e,t,n){var o=this,i=new Node(e,this.snap,this,n,t);i.onclick(function(){o.selector.setTarget(i)}),this.nodes[e]=i},t.prototype.remove=function(e){var t=this.nodes[e];t?t.remove():(t=this.connections[e],t.remove())},t.prototype.updateNode=function(e,t){this.nodes[e].setPos(t.x,t.y),this.nodes[e].setSize(t.w,t.h)},t.prototype.addConnection=function(e,t,n){var o=this,i=new Connection(e,this.snap,this,t,n);i.onclick(function(){o.connection_selector.setTarget(i)}),this.connections[e]=i},t.prototype.updateConnection=function(e,t,n){this.connections[e].setStartPos(t.x,t.y),this.connections[e].setEndPos(n.x,n.y)},t.prototype.on=function(e,t){this.listeners[e].push(t)},t.prototype.fireOnNodeRemove=function(e){this.listeners.noderemove.forEach(function(t){t(e)})},t.prototype.fireOnNodeUpdate=function(e){this.listeners.nodeupdate.forEach(function(t){t(e)})},t.prototype.fireOnConUpdate=function(e){this.listeners.conupdate.forEach(function(t){t(e)})},e.Diagram=t}(window);